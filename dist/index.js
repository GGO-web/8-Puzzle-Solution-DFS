(()=>{"use strict";const e=[{x:0,y:-1,name:"⇐"},{x:-1,y:0,name:"⇑"},{x:0,y:1,name:"⇒"},{x:1,y:0,name:"⇓"}],t={currentState:null,moves:0,settled:0,dropped:0,depth:0,haveSolution:!1},n=(e,t,n=!0)=>{console.log(`Index of the state ${t}`);let o="";for(let t of e){const e=t.map((e=>e||" "));o+="-------------\n",o+=`| ${e[0]} | ${e[1]} | ${e[2]} |\n`}return o+="-------------\n",n&&console.log(o),o},o=e=>{let t={x:0,y:0,name:"empty"};e:for(let n=0;n<e[0].length;++n)for(let o=0;o<e.length;++o)if(null===e[n][o]){t.x=n,t.y=o;break e}return t},s=e=>e.x>=3||e.x<0||e.y>=3||e.y<0;class l{constructor(e,t,o,s,l){this.getState=()=>this.state,this.getMoves=()=>this.operator,this.getDepth=()=>this.depth||1,this.pathFromStart=()=>{let e=[],t=[],o=this;do{e.push(o?.getState()),t.push(o?.getMoves()),o=o?.parent,o&&!o.parent&&e.push(o?.getState())}while(0!==o?.getDepth());e.reverse(),t.reverse();let s=1;for(const t of e)n(t,s),s++;return console.log(`Кількість переміщень: ${t.length}`),console.log(`Переміщення по порядку: ${t.join(", ")}\n`),t},this.state=e,this.parent=t,this.operator=o,this.depth=s,this.cost=l}}let r=t;const a=function(t,n,d,c){for(;c.length;){let h=c.pop();if(h.getDepth()>=1300||r.haveSolution)return n;if(r={...r,currentState:h,settled:d.size,depth:h.getDepth(),haveSolution:!1},i=h.getState(),p=t,i?.toString()===p?.toString())return r.haveSolution=!0,n;const u=o(h.getState());e.forEach((e=>{const o=h?.getState()?.map((e=>[...e])),i={x:u.x+e.x,y:u.y+e.y,name:e.name};s(i)||([o[u.x][u.y],o[i.x][i.y]]=[o[i.x][i.y],o[u.x][u.y]],r.moves++,d.get(o.toString())?r.dropped++:(c.push(new l(o,h,e.name,h.getDepth()+1,0)),d.set(o.toString(),!0),n.push({state:o,index:r.moves+1}),a(t,n,d,c)))}))}var i,p;return n};(()=>{let e=[];const o=document.querySelector(".next"),s=document.querySelector(".result"),d=document.querySelector(".find"),c=document.getElementById("result-content");let i=0;const p=document.getElementById("results");o.disabled=!0,s.disabled=!0,o?.addEventListener("click",(()=>{i>=e.length-1&&(o.disabled=!0);const t=document.createElement("table");t.className+="table table-primary table-hover table-bordered table-sm align-middle caption-top",t.style.width="200px",t.style.height="200px",t.style.textAlign="center",t.insertAdjacentHTML("afterbegin",`\n            <caption class="fw-bold text-primary">\n               Index of the state is ${e[i].index}\n            </caption>\n         `);const s=document.createElement("tbody");for(let t of e[i].state){const e=s.insertRow();for(let n of t){const t=e.insertCell();t.classList.add("align-middle"),t.innerHTML=n?String(n):" "}}t.appendChild(s),p?.appendChild(t),p.scrollTop=p.scrollHeight,n(e[i].state,e[i].index),i++})),s?.addEventListener("click",(()=>{c.innerHTML="",r.haveSolution?(console.log("Порядок переміщень для розв'язку гри в 8:"),console.log(`Кількість відвіданих станів: ${r.moves}`),console.log(`Кількість станів занесених у БД: ${r.settled}`),console.log(`Кількість відкинутих станів: ${r.dropped}`),console.log(`Глибина дерева пошуку на якій знайдено рішення: ${r.depth}`),c.insertAdjacentHTML("beforeend",`\n            <code>\n            <pre>Кількість відвіданих станів: ${r.moves}<br>Кількість станів занесених у БД: ${r.settled}<br>Кількість відкинутих станів: ${r.dropped}<br>Глибина дерева пошуку на якій знайдено рішення: ${r.depth}</pre>\n            </code>\n         `)):(console.log(`Кількість відвіданих станів: ${r.moves}`),console.log(`Кількість станів занесених у БД: ${r.settled}`),console.log(`Кількість відкинутих станів: ${r.dropped}`),console.log("Гра у 8 немає розв'язків"),c.insertAdjacentHTML("beforeend",`\n            <code>\n            <pre>Кількість відвіданих станів : ${r.moves}<br>Кількість станів занесених у БД : ${r.settled}<br>Кількість відкинутих станів : ${r.dropped}<br>Гра у 8 немає розв'язків</pre>\n            </code>\n         `))})),d?.addEventListener("click",(()=>{const n=e=>{const t=[];for(let n of e.rows){const e=[];for(let t of n.cells){const n=parseInt(t.innerHTML);Number.isNaN(n)?e.push(null):e.push(n)}t.push(e)}return t},d=document.querySelector(".initial-state"),c=document.querySelector(".final-state"),h=n(d),u=n(c);i=0,r=t,p.innerHTML=null;const g=new Map;g.set(h.toString(),!0);const m=[new l(h,null,null,0,0)];e=a(u,[{state:h,index:1}],g,m),o.disabled=!1,s.disabled=!1}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQWdCUyxVQUFXLEVBQzNCTixFQUFhTSxVQUFXLENBcUdULEdBRXRCLEVBakhELEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9sYWIxLy4vc3JjL2NvbnN0YW50cy50cyIsIndlYnBhY2s6Ly9sYWIxLy4vc3JjL2hlbHBlcnMudHMiLCJ3ZWJwYWNrOi8vbGFiMS8uL3NyYy9ub2RlLnRzIiwid2VicGFjazovL2xhYjEvLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGZpbmFsU3RhdGUgPSBbXHJcbiAgICBbMSwgMiwgM10sXHJcbiAgICBbNCwgNSwgNl0sXHJcbiAgICBbNywgOCwgbnVsbF0sXHJcbl07XHJcbmV4cG9ydCBjb25zdCBkaXJlY3Rpb25zID0gW1xyXG4gICAgeyB4OiAwLCB5OiAtMSwgbmFtZTogXCLih5BcIiB9LFxyXG4gICAgeyB4OiAtMSwgeTogMCwgbmFtZTogXCLih5FcIiB9LFxyXG4gICAgeyB4OiAwLCB5OiAxLCBuYW1lOiBcIuKHklwiIH0sXHJcbiAgICB7IHg6IDEsIHk6IDAsIG5hbWU6IFwi4oeTXCIgfSxcclxuXTtcclxuZXhwb3J0IGNvbnN0IE1BWF9ERVBUSF9TSVpFID0gMTMwMDtcclxuZXhwb3J0IGNvbnN0IENMRUFOX1JFU1VMVCA9IHtcclxuICAgIGN1cnJlbnRTdGF0ZTogbnVsbCxcclxuICAgIG1vdmVzOiAwLFxyXG4gICAgc2V0dGxlZDogMCxcclxuICAgIGRyb3BwZWQ6IDAsXHJcbiAgICBkZXB0aDogMCxcclxuICAgIGhhdmVTb2x1dGlvbjogZmFsc2UsXHJcbn07XHJcbiIsImV4cG9ydCBmdW5jdGlvbiogZ2V0RXhlY3V0aW9uVGltZSgpIHtcclxuICAgIGNvbnN0IHN0YXJ0VGltZSA9IG5ldyBEYXRlKCk7XHJcbiAgICB5aWVsZCAxO1xyXG4gICAgY29uc3QgZW5kVGltZSA9IG5ldyBEYXRlKCk7XHJcbiAgICBjb25zdCBkaWZmID0gbmV3IERhdGUoZW5kVGltZSAtIHN0YXJ0VGltZSk7XHJcbiAgICBjb25zdCBleGVjdXRpb24gPSBkaWZmLmdldFNlY29uZHMoKSArIDAuMDAxICogZGlmZi5nZXRNaWxsaXNlY29uZHMoKTtcclxuICAgIGNvbnNvbGUubG9nKGBFeGVjdXRpb24gdGltZTogJHtleGVjdXRpb259IHNlY29uZHNgKTtcclxufVxyXG5leHBvcnQgY29uc3QgZGlzcGxheUJvYXJkID0gKHN0YXRlLCBpbmRleCwgZGVidWcgPSB0cnVlKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhgSW5kZXggb2YgdGhlIHN0YXRlICR7aW5kZXh9YCk7XHJcbiAgICBsZXQgZGlzcGxheSA9IFwiXCI7XHJcbiAgICBmb3IgKGxldCByb3cgb2Ygc3RhdGUpIHtcclxuICAgICAgICBjb25zdCBjZWxscyA9IHJvdy5tYXAoKGl0ZW0pID0+ICghaXRlbSA/IFwiIFwiIDogaXRlbSkpO1xyXG4gICAgICAgIGRpc3BsYXkgKz0gXCItLS0tLS0tLS0tLS0tXFxuXCI7XHJcbiAgICAgICAgZGlzcGxheSArPSBgfCAke2NlbGxzWzBdfSB8ICR7Y2VsbHNbMV19IHwgJHtjZWxsc1syXX0gfFxcbmA7XHJcbiAgICB9XHJcbiAgICBkaXNwbGF5ICs9IFwiLS0tLS0tLS0tLS0tLVxcblwiO1xyXG4gICAgaWYgKGRlYnVnKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKGRpc3BsYXkpO1xyXG4gICAgcmV0dXJuIGRpc3BsYXk7XHJcbn07XHJcbmV4cG9ydCBjb25zdCBnZXRFbXB5Q2VsbENvb3JkcyA9IChzdGF0ZSkgPT4ge1xyXG4gICAgbGV0IGNvb3JkaW5hdGVzID0geyB4OiAwLCB5OiAwLCBuYW1lOiBcImVtcHR5XCIgfTtcclxuICAgIG91dGVyOiBmb3IgKGxldCBpID0gMDsgaSA8IHN0YXRlWzBdLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzdGF0ZS5sZW5ndGg7ICsraikge1xyXG4gICAgICAgICAgICBpZiAoc3RhdGVbaV1bal0gPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzLnggPSBpO1xyXG4gICAgICAgICAgICAgICAgY29vcmRpbmF0ZXMueSA9IGo7XHJcbiAgICAgICAgICAgICAgICBicmVhayBvdXRlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBjb29yZGluYXRlcztcclxufTtcclxuZXhwb3J0IGNvbnN0IHN0YXRlc0FyZUVxdWFsID0gKHN0YXRlLCBzZWNvbmRTdGF0ZSkgPT4ge1xyXG4gICAgcmV0dXJuIHN0YXRlPy50b1N0cmluZygpID09PSBzZWNvbmRTdGF0ZT8udG9TdHJpbmcoKTtcclxufTtcclxuZXhwb3J0IGNvbnN0IGlzT3V0T2ZCb3JkZXIgPSAoY29vcmRzKSA9PiB7XHJcbiAgICBpZiAoY29vcmRzLnggPj0gMyB8fCBjb29yZHMueCA8IDApXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICBpZiAoY29vcmRzLnkgPj0gMyB8fCBjb29yZHMueSA8IDApXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn07XHJcbiIsImltcG9ydCB7IGRpc3BsYXlCb2FyZCB9IGZyb20gXCIuL2hlbHBlcnNcIjtcclxuZXhwb3J0IGNsYXNzIE5vZGUge1xyXG4gICAgY29uc3RydWN0b3Ioc3RhdGUsIHBhcmVudCwgb3BlcmF0b3IsIGRlcHRoLCBjb3N0KSB7XHJcbiAgICAgICAgdGhpcy5nZXRTdGF0ZSA9ICgpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGU7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmdldE1vdmVzID0gKCkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5vcGVyYXRvcjtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2V0RGVwdGggPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRlcHRoIHx8IDE7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnBhdGhGcm9tU3RhcnQgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBzdGF0ZUxpc3QgPSBbXTtcclxuICAgICAgICAgICAgbGV0IG1vdmVMaXN0ID0gW107XHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50Tm9kZSA9IHRoaXM7XHJcbiAgICAgICAgICAgIGRvIHtcclxuICAgICAgICAgICAgICAgIHN0YXRlTGlzdC5wdXNoKGN1cnJlbnROb2RlPy5nZXRTdGF0ZSgpKTtcclxuICAgICAgICAgICAgICAgIG1vdmVMaXN0LnB1c2goY3VycmVudE5vZGU/LmdldE1vdmVzKCkpO1xyXG4gICAgICAgICAgICAgICAgY3VycmVudE5vZGUgPSBjdXJyZW50Tm9kZT8ucGFyZW50O1xyXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnROb2RlICYmICFjdXJyZW50Tm9kZS5wYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdGF0ZUxpc3QucHVzaChjdXJyZW50Tm9kZT8uZ2V0U3RhdGUoKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gd2hpbGUgKGN1cnJlbnROb2RlPy5nZXREZXB0aCgpICE9PSAwKTtcclxuICAgICAgICAgICAgc3RhdGVMaXN0LnJldmVyc2UoKTtcclxuICAgICAgICAgICAgbW92ZUxpc3QucmV2ZXJzZSgpO1xyXG4gICAgICAgICAgICBsZXQgaW5kZXggPSAxO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2Ygc3RhdGVMaXN0KSB7XHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5Qm9hcmQoaXRlbSwgaW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgaW5kZXgrKztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg0JrRltC70YzQutGW0YHRgtGMINC/0LXRgNC10LzRltGJ0LXQvdGMOiAke21vdmVMaXN0Lmxlbmd0aH1gKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYNCf0LXRgNC10LzRltGJ0LXQvdC90Y8g0L/QviDQv9C+0YDRj9C00LrRgzogJHttb3ZlTGlzdC5qb2luKFwiLCBcIil9XFxuYCk7XHJcbiAgICAgICAgICAgIHJldHVybiBtb3ZlTGlzdDtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcclxuICAgICAgICB0aGlzLm9wZXJhdG9yID0gb3BlcmF0b3I7XHJcbiAgICAgICAgdGhpcy5kZXB0aCA9IGRlcHRoO1xyXG4gICAgICAgIHRoaXMuY29zdCA9IGNvc3Q7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQ0xFQU5fUkVTVUxULCBkaXJlY3Rpb25zLCBNQVhfREVQVEhfU0laRSB9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xyXG5pbXBvcnQgeyBkaXNwbGF5Qm9hcmQsIGdldEVtcHlDZWxsQ29vcmRzLCBpc091dE9mQm9yZGVyLCBzdGF0ZXNBcmVFcXVhbCwgfSBmcm9tIFwiLi9oZWxwZXJzXCI7XHJcbmltcG9ydCB7IE5vZGUgfSBmcm9tIFwiLi9ub2RlXCI7XHJcbmxldCByZXN1bHRzID0gQ0xFQU5fUkVTVUxUO1xyXG5jb25zdCBERlMgPSBmdW5jdGlvbiAoZmluYWwsIHN0YXRlcywgZGIsIHF1ZXVlKSB7XHJcbiAgICB3aGlsZSAocXVldWUubGVuZ3RoKSB7XHJcbiAgICAgICAgbGV0IGN1cnJlbnRTdGF0ZSA9IHF1ZXVlLnBvcCgpO1xyXG4gICAgICAgIGlmIChjdXJyZW50U3RhdGUuZ2V0RGVwdGgoKSA+PSBNQVhfREVQVEhfU0laRSB8fCByZXN1bHRzLmhhdmVTb2x1dGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gc3RhdGVzO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXN1bHRzID0ge1xyXG4gICAgICAgICAgICAuLi5yZXN1bHRzLFxyXG4gICAgICAgICAgICBjdXJyZW50U3RhdGU6IGN1cnJlbnRTdGF0ZSxcclxuICAgICAgICAgICAgc2V0dGxlZDogZGIuc2l6ZSxcclxuICAgICAgICAgICAgZGVwdGg6IGN1cnJlbnRTdGF0ZS5nZXREZXB0aCgpLFxyXG4gICAgICAgICAgICBoYXZlU29sdXRpb246IGZhbHNlLFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKHN0YXRlc0FyZUVxdWFsKGN1cnJlbnRTdGF0ZS5nZXRTdGF0ZSgpLCBmaW5hbCkpIHtcclxuICAgICAgICAgICAgcmVzdWx0cy5oYXZlU29sdXRpb24gPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gc3RhdGVzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBlbXB0eUNlbGwgPSBnZXRFbXB5Q2VsbENvb3JkcyhjdXJyZW50U3RhdGUuZ2V0U3RhdGUoKSk7XHJcbiAgICAgICAgZGlyZWN0aW9ucy5mb3JFYWNoKChkaXJlY3Rpb24pID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY29weVN0YXRlID0gY3VycmVudFN0YXRlXHJcbiAgICAgICAgICAgICAgICA/LmdldFN0YXRlKClcclxuICAgICAgICAgICAgICAgID8ubWFwKChyb3cpID0+IFsuLi5yb3ddKTtcclxuICAgICAgICAgICAgLy8gY29vcmRzIGNlbGwgdG8gc3dpdGNoXHJcbiAgICAgICAgICAgIGNvbnN0IGNvb3JkcyA9IHtcclxuICAgICAgICAgICAgICAgIHg6IGVtcHR5Q2VsbC54ICsgZGlyZWN0aW9uLngsXHJcbiAgICAgICAgICAgICAgICB5OiBlbXB0eUNlbGwueSArIGRpcmVjdGlvbi55LFxyXG4gICAgICAgICAgICAgICAgbmFtZTogZGlyZWN0aW9uLm5hbWUsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIC8vIGlmIGNvb3JkcyBvZiBzd2FwcGVkIGNlbGwgaXMgbm90IG91dCB0aGUgYm9yZGVyIG9mIHRoZSBmaWVsZFxyXG4gICAgICAgICAgICBpZiAoIWlzT3V0T2ZCb3JkZXIoY29vcmRzKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gbW92ZSBlbXB0eSBjZWxsIGludG8gY3VycmVudCBkaXJlY3Rpb25cclxuICAgICAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgICAgICBjb3B5U3RhdGVbZW1wdHlDZWxsLnhdW2VtcHR5Q2VsbC55XSxcclxuICAgICAgICAgICAgICAgICAgICBjb3B5U3RhdGVbY29vcmRzLnhdW2Nvb3Jkcy55XSxcclxuICAgICAgICAgICAgICAgIF0gPSBbXHJcbiAgICAgICAgICAgICAgICAgICAgY29weVN0YXRlW2Nvb3Jkcy54XVtjb29yZHMueV0sXHJcbiAgICAgICAgICAgICAgICAgICAgY29weVN0YXRlW2VtcHR5Q2VsbC54XVtlbXB0eUNlbGwueV0sXHJcbiAgICAgICAgICAgICAgICBdO1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0cy5tb3ZlcysrO1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgc3dhcHBlZCBzdGF0ZSBpcyBub3QgcHJlc2VudCBpbiBkYXRhYmFzZVxyXG4gICAgICAgICAgICAgICAgaWYgKCFkYi5nZXQoY29weVN0YXRlLnRvU3RyaW5nKCkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVldWUucHVzaChuZXcgTm9kZShjb3B5U3RhdGUsIGN1cnJlbnRTdGF0ZSwgZGlyZWN0aW9uLm5hbWUsIGN1cnJlbnRTdGF0ZS5nZXREZXB0aCgpICsgMSwgMCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGRiLnNldChjb3B5U3RhdGUudG9TdHJpbmcoKSwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdGVzLnB1c2goeyBzdGF0ZTogY29weVN0YXRlLCBpbmRleDogcmVzdWx0cy5tb3ZlcyArIDEgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgREZTKGZpbmFsLCBzdGF0ZXMsIGRiLCBxdWV1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN1bHRzLmRyb3BwZWQrKztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHN0YXRlcztcclxufTtcclxuKCgpID0+IHtcclxuICAgIGxldCBhbGxTdGF0ZXMgPSBbXTtcclxuICAgIGNvbnN0IG5leHRTdGF0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV4dFwiKTtcclxuICAgIGNvbnN0IHJlc3VsdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmVzdWx0XCIpO1xyXG4gICAgY29uc3QgZmluZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZmluZFwiKTtcclxuICAgIGNvbnN0IHJlc3VsdENvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc3VsdC1jb250ZW50XCIpO1xyXG4gICAgbGV0IGluZGV4T2ZOZXh0U3RhdGUgPSAwO1xyXG4gICAgY29uc3QgcmVzdWx0c1dyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlc3VsdHNcIik7XHJcbiAgICBjb25zdCB1bmxvY2tCdXR0b25zID0gKCkgPT4ge1xyXG4gICAgICAgIG5leHRTdGF0ZUJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIHJlc3VsdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfTtcclxuICAgIGNvbnN0IGRpc2FibGVCdXR0b25zID0gKCkgPT4ge1xyXG4gICAgICAgIG5leHRTdGF0ZUJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgcmVzdWx0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBjb25zdCBwcmludFJlc3VsdHMgPSAoKSA9PiB7XHJcbiAgICAgICAgcmVzdWx0Q29udGVudC5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgICAgIGlmICghcmVzdWx0cy5oYXZlU29sdXRpb24pIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDQstGW0LTQstGW0LTQsNC90LjRhSDRgdGC0LDQvdGW0LI6ICR7cmVzdWx0cy5tb3Zlc31gKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYNCa0ZbQu9GM0LrRltGB0YLRjCDRgdGC0LDQvdGW0LIg0LfQsNC90LXRgdC10L3QuNGFINGDINCR0JQ6ICR7cmVzdWx0cy5zZXR0bGVkfWApO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg0JrRltC70YzQutGW0YHRgtGMINCy0ZbQtNC60LjQvdGD0YLQuNGFINGB0YLQsNC90ZbQsjogJHtyZXN1bHRzLmRyb3BwZWR9YCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi0JPRgNCwINGDIDgg0L3QtdC80LDRlCDRgNC+0LfQsifRj9C30LrRltCyXCIpO1xyXG4gICAgICAgICAgICByZXN1bHRDb250ZW50Lmluc2VydEFkamFjZW50SFRNTChcImJlZm9yZWVuZFwiLCBgXG4gICAgICAgICAgICA8Y29kZT5cbiAgICAgICAgICAgIDxwcmU+0JrRltC70YzQutGW0YHRgtGMINCy0ZbQtNCy0ZbQtNCw0L3QuNGFINGB0YLQsNC90ZbQsiA6ICR7cmVzdWx0cy5tb3Zlc308YnI+0JrRltC70YzQutGW0YHRgtGMINGB0YLQsNC90ZbQsiDQt9Cw0L3QtdGB0LXQvdC40YUg0YMg0JHQlCA6ICR7cmVzdWx0cy5zZXR0bGVkfTxicj7QmtGW0LvRjNC60ZbRgdGC0Ywg0LLRltC00LrQuNC90YPRgtC40YUg0YHRgtCw0L3RltCyIDogJHtyZXN1bHRzLmRyb3BwZWR9PGJyPtCT0YDQsCDRgyA4INC90LXQvNCw0ZQg0YDQvtC30LIn0Y/Qt9C60ZbQsjwvcHJlPlxuICAgICAgICAgICAgPC9jb2RlPlxuICAgICAgICAgYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcItCf0L7RgNGP0LTQvtC6INC/0LXRgNC10LzRltGJ0LXQvdGMINC00LvRjyDRgNC+0LfQsifRj9C30LrRgyDQs9GA0Lgg0LIgODpcIik7XHJcbiAgICAgICAgICAgIC8vIHJlc3VsdHM/LmN1cnJlbnRTdGF0ZT8ucGF0aEZyb21TdGFydCgpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg0JrRltC70YzQutGW0YHRgtGMINCy0ZbQtNCy0ZbQtNCw0L3QuNGFINGB0YLQsNC90ZbQsjogJHtyZXN1bHRzLm1vdmVzfWApO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhg0JrRltC70YzQutGW0YHRgtGMINGB0YLQsNC90ZbQsiDQt9Cw0L3QtdGB0LXQvdC40YUg0YMg0JHQlDogJHtyZXN1bHRzLnNldHRsZWR9YCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGDQmtGW0LvRjNC60ZbRgdGC0Ywg0LLRltC00LrQuNC90YPRgtC40YUg0YHRgtCw0L3RltCyOiAke3Jlc3VsdHMuZHJvcHBlZH1gKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYNCT0LvQuNCx0LjQvdCwINC00LXRgNC10LLQsCDQv9C+0YjRg9C60YMg0L3QsCDRj9C60ZbQuSDQt9C90LDQudC00LXQvdC+INGA0ZbRiNC10L3QvdGPOiAke3Jlc3VsdHMuZGVwdGh9YCk7XHJcbiAgICAgICAgICAgIHJlc3VsdENvbnRlbnQuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYmVmb3JlZW5kXCIsIGBcbiAgICAgICAgICAgIDxjb2RlPlxuICAgICAgICAgICAgPHByZT7QmtGW0LvRjNC60ZbRgdGC0Ywg0LLRltC00LLRltC00LDQvdC40YUg0YHRgtCw0L3RltCyOiAke3Jlc3VsdHMubW92ZXN9PGJyPtCa0ZbQu9GM0LrRltGB0YLRjCDRgdGC0LDQvdGW0LIg0LfQsNC90LXRgdC10L3QuNGFINGDINCR0JQ6ICR7cmVzdWx0cy5zZXR0bGVkfTxicj7QmtGW0LvRjNC60ZbRgdGC0Ywg0LLRltC00LrQuNC90YPRgtC40YUg0YHRgtCw0L3RltCyOiAke3Jlc3VsdHMuZHJvcHBlZH08YnI+0JPQu9C40LHQuNC90LAg0LTQtdGA0LXQstCwINC/0L7RiNGD0LrRgyDQvdCwINGP0LrRltC5INC30L3QsNC50LTQtdC90L4g0YDRltGI0LXQvdC90Y86ICR7cmVzdWx0cy5kZXB0aH08L3ByZT5cbiAgICAgICAgICAgIDwvY29kZT5cbiAgICAgICAgIGApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBkaXNhYmxlQnV0dG9ucygpO1xyXG4gICAgbmV4dFN0YXRlQnV0dG9uPy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIGlmIChpbmRleE9mTmV4dFN0YXRlID49IGFsbFN0YXRlcy5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgIG5leHRTdGF0ZUJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEFkZCBuZXh0IG5ldyBzdGF0ZSB0YWJsZSB0byB0aGUgdmlld1xyXG4gICAgICAgIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRhYmxlXCIpO1xyXG4gICAgICAgIHRhYmxlLmNsYXNzTmFtZSArPVxyXG4gICAgICAgICAgICBcInRhYmxlIHRhYmxlLXByaW1hcnkgdGFibGUtaG92ZXIgdGFibGUtYm9yZGVyZWQgdGFibGUtc20gYWxpZ24tbWlkZGxlIGNhcHRpb24tdG9wXCI7XHJcbiAgICAgICAgdGFibGUuc3R5bGUud2lkdGggPSBcIjIwMHB4XCI7XHJcbiAgICAgICAgdGFibGUuc3R5bGUuaGVpZ2h0ID0gXCIyMDBweFwiO1xyXG4gICAgICAgIHRhYmxlLnN0eWxlLnRleHRBbGlnbiA9IFwiY2VudGVyXCI7XHJcbiAgICAgICAgdGFibGUuaW5zZXJ0QWRqYWNlbnRIVE1MKFwiYWZ0ZXJiZWdpblwiLCBgXG4gICAgICAgICAgICA8Y2FwdGlvbiBjbGFzcz1cImZ3LWJvbGQgdGV4dC1wcmltYXJ5XCI+XG4gICAgICAgICAgICAgICBJbmRleCBvZiB0aGUgc3RhdGUgaXMgJHthbGxTdGF0ZXNbaW5kZXhPZk5leHRTdGF0ZV0uaW5kZXh9XG4gICAgICAgICAgICA8L2NhcHRpb24+XG4gICAgICAgICBgKTtcclxuICAgICAgICBjb25zdCB0Ym9keSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0Ym9keVwiKTtcclxuICAgICAgICBmb3IgKGxldCByb3cgb2YgYWxsU3RhdGVzW2luZGV4T2ZOZXh0U3RhdGVdLnN0YXRlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhYmxlUm93ID0gdGJvZHkuaW5zZXJ0Um93KCk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGNvbCBvZiByb3cpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRkID0gdGFibGVSb3cuaW5zZXJ0Q2VsbCgpO1xyXG4gICAgICAgICAgICAgICAgdGQuY2xhc3NMaXN0LmFkZChcImFsaWduLW1pZGRsZVwiKTtcclxuICAgICAgICAgICAgICAgIGlmICghY29sKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGQuaW5uZXJIVE1MID0gXCIgXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZC5pbm5lckhUTUwgPSBTdHJpbmcoY29sKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0YWJsZS5hcHBlbmRDaGlsZCh0Ym9keSk7XHJcbiAgICAgICAgcmVzdWx0c1dyYXBwZXI/LmFwcGVuZENoaWxkKHRhYmxlKTtcclxuICAgICAgICByZXN1bHRzV3JhcHBlci5zY3JvbGxUb3AgPSByZXN1bHRzV3JhcHBlci5zY3JvbGxIZWlnaHQ7XHJcbiAgICAgICAgLy8gcHJpbnQgcmVzdWx0cyB0byB0aGUgY29uc29sZVxyXG4gICAgICAgIGRpc3BsYXlCb2FyZChhbGxTdGF0ZXNbaW5kZXhPZk5leHRTdGF0ZV0uc3RhdGUsIGFsbFN0YXRlc1tpbmRleE9mTmV4dFN0YXRlXS5pbmRleCk7XHJcbiAgICAgICAgaW5kZXhPZk5leHRTdGF0ZSsrO1xyXG4gICAgfSk7XHJcbiAgICByZXN1bHRCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgcHJpbnRSZXN1bHRzKCk7XHJcbiAgICB9KTtcclxuICAgIGZpbmRCdXR0b24/LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZ2V0VGFibGVTdGF0ZSA9ICh0YWJsZSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBzdGF0ZSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKGxldCByb3cgb2YgdGFibGUucm93cykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhdGVSb3cgPSBbXTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGNlbGwgb2Ygcm93LmNlbGxzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2VsbERhdGEgPSBwYXJzZUludChjZWxsLmlubmVySFRNTCk7XHJcbiAgICAgICAgICAgICAgICAgICAgTnVtYmVyLmlzTmFOKGNlbGxEYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA/IHN0YXRlUm93LnB1c2gobnVsbClcclxuICAgICAgICAgICAgICAgICAgICAgICAgOiBzdGF0ZVJvdy5wdXNoKGNlbGxEYXRhKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHN0YXRlLnB1c2goc3RhdGVSb3cpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBzdGF0ZTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IGluaXRpYWxTdGF0ZVRhYmxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbml0aWFsLXN0YXRlXCIpO1xyXG4gICAgICAgIGNvbnN0IGZpbmFsU3RhdGVUYWJsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZmluYWwtc3RhdGVcIik7XHJcbiAgICAgICAgY29uc3QgaW5pdGlhbCA9IGdldFRhYmxlU3RhdGUoaW5pdGlhbFN0YXRlVGFibGUpO1xyXG4gICAgICAgIGNvbnN0IGZpbmFsID0gZ2V0VGFibGVTdGF0ZShmaW5hbFN0YXRlVGFibGUpO1xyXG4gICAgICAgIC8vIHJlc2V0IHN0ZXAgYnkgc3RlcCByZXN1bHRzIG91dHB1dFxyXG4gICAgICAgIGluZGV4T2ZOZXh0U3RhdGUgPSAwO1xyXG4gICAgICAgIHJlc3VsdHMgPSBDTEVBTl9SRVNVTFQ7XHJcbiAgICAgICAgcmVzdWx0c1dyYXBwZXIuaW5uZXJIVE1MID0gbnVsbDtcclxuICAgICAgICBjb25zdCBkYiA9IG5ldyBNYXAoKTtcclxuICAgICAgICBkYi5zZXQoaW5pdGlhbC50b1N0cmluZygpLCB0cnVlKTtcclxuICAgICAgICBjb25zdCBxdWV1ZSA9IFtuZXcgTm9kZShpbml0aWFsLCBudWxsLCBudWxsLCAwLCAwKV07XHJcbiAgICAgICAgYWxsU3RhdGVzID0gREZTKGZpbmFsLCBbeyBzdGF0ZTogaW5pdGlhbCwgaW5kZXg6IDEgfV0sIGRiLCBxdWV1ZSk7XHJcbiAgICAgICAgdW5sb2NrQnV0dG9ucygpO1xyXG4gICAgfSk7XHJcbn0pKCk7XHJcbiJdLCJuYW1lcyI6WyJkaXJlY3Rpb25zIiwieCIsInkiLCJuYW1lIiwiQ0xFQU5fUkVTVUxUIiwiY3VycmVudFN0YXRlIiwibW92ZXMiLCJzZXR0bGVkIiwiZHJvcHBlZCIsImRlcHRoIiwiaGF2ZVNvbHV0aW9uIiwiZGlzcGxheUJvYXJkIiwic3RhdGUiLCJpbmRleCIsImRlYnVnIiwiY29uc29sZSIsImxvZyIsImRpc3BsYXkiLCJyb3ciLCJjZWxscyIsIm1hcCIsIml0ZW0iLCJnZXRFbXB5Q2VsbENvb3JkcyIsImNvb3JkaW5hdGVzIiwib3V0ZXIiLCJpIiwibGVuZ3RoIiwiaiIsImlzT3V0T2ZCb3JkZXIiLCJjb29yZHMiLCJOb2RlIiwiY29uc3RydWN0b3IiLCJwYXJlbnQiLCJvcGVyYXRvciIsImNvc3QiLCJ0aGlzIiwiZ2V0U3RhdGUiLCJnZXRNb3ZlcyIsImdldERlcHRoIiwicGF0aEZyb21TdGFydCIsInN0YXRlTGlzdCIsIm1vdmVMaXN0IiwiY3VycmVudE5vZGUiLCJwdXNoIiwicmV2ZXJzZSIsImpvaW4iLCJyZXN1bHRzIiwiREZTIiwiZmluYWwiLCJzdGF0ZXMiLCJkYiIsInF1ZXVlIiwicG9wIiwic2l6ZSIsInNlY29uZFN0YXRlIiwidG9TdHJpbmciLCJlbXB0eUNlbGwiLCJmb3JFYWNoIiwiZGlyZWN0aW9uIiwiY29weVN0YXRlIiwiZ2V0Iiwic2V0IiwiYWxsU3RhdGVzIiwibmV4dFN0YXRlQnV0dG9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicmVzdWx0QnV0dG9uIiwiZmluZEJ1dHRvbiIsInJlc3VsdENvbnRlbnQiLCJnZXRFbGVtZW50QnlJZCIsImluZGV4T2ZOZXh0U3RhdGUiLCJyZXN1bHRzV3JhcHBlciIsImRpc2FibGVkIiwiYWRkRXZlbnRMaXN0ZW5lciIsInRhYmxlIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInN0eWxlIiwid2lkdGgiLCJoZWlnaHQiLCJ0ZXh0QWxpZ24iLCJpbnNlcnRBZGphY2VudEhUTUwiLCJ0Ym9keSIsInRhYmxlUm93IiwiaW5zZXJ0Um93IiwiY29sIiwidGQiLCJpbnNlcnRDZWxsIiwiY2xhc3NMaXN0IiwiYWRkIiwiaW5uZXJIVE1MIiwiU3RyaW5nIiwiYXBwZW5kQ2hpbGQiLCJzY3JvbGxUb3AiLCJzY3JvbGxIZWlnaHQiLCJnZXRUYWJsZVN0YXRlIiwicm93cyIsInN0YXRlUm93IiwiY2VsbCIsImNlbGxEYXRhIiwicGFyc2VJbnQiLCJOdW1iZXIiLCJpc05hTiIsImluaXRpYWxTdGF0ZVRhYmxlIiwiZmluYWxTdGF0ZVRhYmxlIiwiaW5pdGlhbCIsIk1hcCJdLCJzb3VyY2VSb290IjoiIn0=